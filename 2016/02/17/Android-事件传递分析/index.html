<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  <meta http-equiv="X-UA-Compatible" content="IE=edge" >
  <title>Android 事件传递分析 | Azzwen的博客</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description" content="事件传递是 Android 开发必须掌握的基础内容，在处理自定义 View 交互时尤其重要。之前看过不少分析事件传递的文章，但理解的不够透彻，遇到具体问题还是无从下手。为了解决这个问题，决定从源码角度梳理一下 ViewGroup View Activity 的事件传递流程。">
<meta property="og:type" content="article">
<meta property="og:title" content="Android 事件传递分析">
<meta property="og:url" content="http://azzwen.github.io/2016/02/17/Android-事件传递分析/index.html">
<meta property="og:site_name" content="Azzwen的博客">
<meta property="og:description" content="事件传递是 Android 开发必须掌握的基础内容，在处理自定义 View 交互时尤其重要。之前看过不少分析事件传递的文章，但理解的不够透彻，遇到具体问题还是无从下手。为了解决这个问题，决定从源码角度梳理一下 ViewGroup View Activity 的事件传递流程。">
<meta property="og:image" content="http://azzwen.github.io/assets/images/android 事件传递分析/test_01.png">
<meta property="og:image" content="http://azzwen.github.io/assets/images/android 事件传递分析/test_02.png">
<meta property="og:image" content="http://azzwen.github.io/assets/images/android 事件传递分析/test_03.png">
<meta property="og:image" content="http://azzwen.github.io/assets/images/android 事件传递分析/test_04.png">
<meta property="og:updated_time" content="2016-02-19T08:43:20.031Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Android 事件传递分析">
<meta name="twitter:description" content="事件传递是 Android 开发必须掌握的基础内容，在处理自定义 View 交互时尤其重要。之前看过不少分析事件传递的文章，但理解的不够透彻，遇到具体问题还是无从下手。为了解决这个问题，决定从源码角度梳理一下 ViewGroup View Activity 的事件传递流程。">
  
  
    <link rel="icon" href="/favicon.png">
  
  <link rel="stylesheet" href="/css/style.css" type="text/css">
</head>

<body>
  <div id="container">
    <div class="left-col">
    <div class="overlay"></div>
<div class="intrude-less">
	<header id="header" class="inner">
		<a href="/" class="profilepic">
			
			<img lazy-src="/assets/images/avatar.jpg" class="js-avatar">
			
		</a>

		<hgroup>
		  <h1 class="header-author"><a href="/">Azzwen</a></h1>
		</hgroup>

		
		<p class="header-subtitle">不畏路远，只怕心老。</p>
		

		
			<div class="switch-btn">
				<div class="icon">
					<div class="icon-ctn">
						<div class="icon-wrap icon-house" data-idx="0">
							<div class="birdhouse"></div>
							<div class="birdhouse_holes"></div>
						</div>
						<div class="icon-wrap icon-ribbon hide" data-idx="1">
							<div class="ribbon"></div>
						</div>
						
						<div class="icon-wrap icon-link hide" data-idx="2">
							<div class="loopback_l"></div>
							<div class="loopback_r"></div>
						</div>
						
						
						<div class="icon-wrap icon-me hide" data-idx="3">
							<div class="user"></div>
							<div class="shoulder"></div>
						</div>
						
					</div>
					
				</div>
				<div class="tips-box hide">
					<div class="tips-arrow"></div>
					<ul class="tips-inner">
						<li>菜单</li>
						<li>标签</li>
						
						<li>友情链接</li>
						
						
						<li>关于我</li>
						
					</ul>
				</div>
			</div>
		

		<div class="switch-area">
			<div class="switch-wrap">
				<section class="switch-part switch-part1">
					<nav class="header-menu">
						<ul>
						
							<li><a href="/">主页</a></li>
				        
							<li><a href="/archives">所有文章</a></li>
				        
						</ul>
					</nav>
					<nav class="header-nav">
						<div class="social">
							
								<a class="github" target="_blank" href="https://github.com/azzwen" title="github">github</a>
					        
								<a class="rss" target="_blank" href="/atom.xml" title="rss">rss</a>
					        
						</div>
					</nav>
				</section>
				
				
				<section class="switch-part switch-part2">
					<div class="widget tagcloud" id="js-tagcloud">
						<a href="/tags/Android/" style="font-size: 20px;">Android</a> <a href="/tags/LinearLayout/" style="font-size: 10px;">LinearLayout</a> <a href="/tags/measure/" style="font-size: 10px;">measure</a> <a href="/tags/事件传递/" style="font-size: 10px;">事件传递</a> <a href="/tags/杂谈/" style="font-size: 10px;">杂谈</a>
					</div>
				</section>
				
				
				
				<section class="switch-part switch-part3">
					<div id="js-friends">
					
			          <a target="_blank" class="main-nav-link switch-friends-link" href="http://jirry.github.io/">Jirry的博客</a>
			        
			          <a target="_blank" class="main-nav-link switch-friends-link" href="http://hipooo.github.io/">hippo的博客</a>
			        
			        </div>
				</section>
				

				
				
				<section class="switch-part switch-part4">
				
					<div id="js-aboutme">在路上的 Android 菜鸟。</div>
				</section>
				
			</div>
		</div>
	</header>				
</div>

    </div>
    <div class="mid-col">
      <nav id="mobile-nav">
  	<div class="overlay">
  		<div class="slider-trigger"></div>
  		<h1 class="header-author js-mobile-header hide">Azzwen</h1>
  	</div>
	<div class="intrude-less">
		<header id="header" class="inner">
			<div class="profilepic">
			
				<img lazy-src="/assets/images/avatar.jpg" class="js-avatar">
			
			</div>
			<hgroup>
			  <h1 class="header-author">Azzwen</h1>
			</hgroup>
			
			<p class="header-subtitle">不畏路远，只怕心老。</p>
			
			<nav class="header-menu">
				<ul>
				
					<li><a href="/">主页</a></li>
		        
					<li><a href="/archives">所有文章</a></li>
		        
		        <div class="clearfix"></div>
				</ul>
			</nav>
			<nav class="header-nav">
				<div class="social">
					
						<a class="github" target="_blank" href="https://github.com/azzwen" title="github">github</a>
			        
						<a class="rss" target="_blank" href="/atom.xml" title="rss">rss</a>
			        
				</div>
			</nav>
		</header>				
	</div>
</nav>

      <div class="body-wrap"><article id="post-Android-事件传递分析" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2016/02/17/Android-事件传递分析/" class="article-date">
  	<time datetime="2016-02-17T09:20:59.000Z" itemprop="datePublished">2016-02-17</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 class="article-title" itemprop="name">
      Android 事件传递分析
    </h1>
  

      </header>
      
      <div class="article-info article-info-post">
        
	<div class="article-tag tagcloud">
		<ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Android/">Android</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/事件传递/">事件传递</a></li></ul>
	</div>

        

        <div class="clearfix"></div>
      </div>
      
    
    <div class="article-entry" itemprop="articleBody">
      
        <p><strong>&#x4E8B;&#x4EF6;&#x4F20;&#x9012;</strong>&#x662F; Android &#x5F00;&#x53D1;&#x5FC5;&#x987B;&#x638C;&#x63E1;&#x7684;&#x57FA;&#x7840;&#x5185;&#x5BB9;&#xFF0C;&#x5728;&#x5904;&#x7406;&#x81EA;&#x5B9A;&#x4E49; View &#x4EA4;&#x4E92;&#x65F6;&#x5C24;&#x5176;&#x91CD;&#x8981;&#x3002;&#x4E4B;&#x524D;&#x770B;&#x8FC7;&#x4E0D;&#x5C11;&#x5206;&#x6790;&#x4E8B;&#x4EF6;&#x4F20;&#x9012;&#x7684;&#x6587;&#x7AE0;&#xFF0C;&#x4F46;&#x7406;&#x89E3;&#x7684;&#x4E0D;&#x591F;&#x900F;&#x5F7B;&#xFF0C;&#x9047;&#x5230;&#x5177;&#x4F53;&#x95EE;&#x9898;&#x8FD8;&#x662F;&#x65E0;&#x4ECE;&#x4E0B;&#x624B;&#x3002;<br>&#x4E3A;&#x4E86;&#x89E3;&#x51B3;&#x8FD9;&#x4E2A;&#x95EE;&#x9898;&#xFF0C;&#x51B3;&#x5B9A;&#x4ECE;&#x6E90;&#x7801;&#x89D2;&#x5EA6;&#x68B3;&#x7406;&#x4E00;&#x4E0B; <code>ViewGroup</code> <code>View</code> <code>Activity</code> &#x7684;&#x4E8B;&#x4EF6;&#x4F20;&#x9012;&#x6D41;&#x7A0B;&#x3002;</p>
<a id="more"></a>
<blockquote>
<p>&#x5206;&#x6790;&#x4F7F;&#x7528;&#x7248;&#x672C; 4.0.1 r1<br>&#x6E90;&#x7801;&#x5730;&#x5740; <a href="http://grepcode.com/file/repository.grepcode.com/java/ext/com.google.android/android/4.1.2_r1/android/view/View.java?av=f" target="_blank" rel="external"><code>View</code></a> <a href="http://grepcode.com/file/repository.grepcode.com/java/ext/com.google.android/android/4.1.2_r1/android/view/ViewGroup.java?av=f" target="_blank" rel="external"><code>GroupView</code></a> <a href="http://grepcode.com/file/repository.grepcode.com/java/ext/com.google.android/android/4.0.1_r1/com/android/internal/policy/impl/PhoneWindow.java?av=f" target="_blank" rel="external"><code>PhoneWindow</code></a></p>
</blockquote>
<!-- toc -->
<ul>
<li><a href="#&#x57FA;&#x7840;&#x77E5;&#x8BC6;">&#x57FA;&#x7840;&#x77E5;&#x8BC6;</a></li>
<li><a href="#&#x6E90;&#x7801;&#x89E3;&#x6790;">&#x6E90;&#x7801;&#x89E3;&#x6790;</a><ul>
<li><a href="#view-&#x6E90;&#x7801;&#x89E3;&#x6790;">View &#x6E90;&#x7801;&#x89E3;&#x6790;</a><ul>
<li><a href="#viewontouchevent">View.onTouchEvent</a></li>
<li><a href="#viewdispathtouchevent">View.DispathTouchEvent</a></li>
</ul>
</li>
<li><a href="#viewgroup-&#x6E90;&#x7801;&#x5206;&#x6790;">ViewGroup &#x6E90;&#x7801;&#x5206;&#x6790;</a><ul>
<li><a href="#viewgroupontouchevent">ViewGroup.onTouchEvent</a></li>
<li><a href="#viewgrouponintercepttoucheevent">ViewGroup.onInterceptToucheEvent</a></li>
<li><a href="#viewgroupdispatchtouch">ViewGroup.dispatchTouch</a></li>
</ul>
</li>
<li><a href="#activity-&#x6E90;&#x7801;&#x5206;&#x6790;">Activity &#x6E90;&#x7801;&#x5206;&#x6790;</a><ul>
<li><a href="#activityontouchevent">Activity.onTouchEvent</a></li>
<li><a href="#activitydispatchtouchevent">Activity.dispatchTouchEvent</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#&#x4EE3;&#x7801;&#x6D4B;&#x8BD5;">&#x4EE3;&#x7801;&#x6D4B;&#x8BD5;</a><ul>
<li><a href="#span-idtest_1&#x6D4B;&#x8BD5;&#x4E00;span"><span id="test_1">&#x6D4B;&#x8BD5;&#x4E00;</span></a></li>
<li><a href="#span-idtest_2&#x6D4B;&#x8BD5;&#x4E8C;span"><span id="test_2">&#x6D4B;&#x8BD5;&#x4E8C;</span></a></li>
<li><a href="#span-idtest_3&#x6D4B;&#x8BD5;&#x4E09;span"><span id="test_3">&#x6D4B;&#x8BD5;&#x4E09;</span></a></li>
<li><a href="#span-idtest_4&#x6D4B;&#x8BD5;&#x56DB;span"><span id="test_4">&#x6D4B;&#x8BD5;&#x56DB;</span></a></li>
</ul>
</li>
<li><a href="#&#x53C2;&#x8003;&#x94FE;&#x63A5;">&#x53C2;&#x8003;&#x94FE;&#x63A5;</a></li>
</ul>
<!-- tocstop -->
<h2 id="&#x57FA;&#x7840;&#x77E5;&#x8BC6;"><a href="#&#x57FA;&#x7840;&#x77E5;&#x8BC6;" class="headerlink" title="&#x57FA;&#x7840;&#x77E5;&#x8BC6;"></a>&#x57FA;&#x7840;&#x77E5;&#x8BC6;</h2><p>&#x89E6;&#x6478;&#x4E8B;&#x4EF6;&#x5206;&#x4E3A; <strong>ACTION_DOWN</strong>, <strong>ACTION_UP</strong>, <strong>ACTION_MOVE</strong>, <strong>ACTION_POINTER_DOWN</strong>, <strong>ACTION_POINTER_UP</strong>, <strong>ACTION_CANCEL</strong> &#x3002;</p>
<ul>
<li>&#x5728;&#x652F;&#x6301;&#x591A;&#x70B9;&#x89E6;&#x6478;&#x7684;&#x5C4F;&#x5E55;&#x4E0A;&#xFF0C;&#x5F53;&#x7B2C;&#x4E00;&#x6839;&#x624B;&#x6307;&#x6309;&#x4E0B;&#x65F6;&#xFF0C;&#x89E6;&#x53D1; ACTION_DOWN &#x4E8B;&#x4EF6;&#xFF0C;&#x4E4B;&#x540E;&#x7684;&#x6309;&#x4E0B;&#x64CD;&#x4F5C;&#x89E6;&#x53D1; ACTION_POINTER_DOWN &#x4E8B;&#x4EF6;&#x3002;&#x540C;&#x7406;&#xFF0C;&#x975E;&#x6700;&#x540E;&#x4E00;&#x6839;&#x624B;&#x6307;&#x7684;&#x62AC;&#x8D77;&#x64CD;&#x4F5C;&#x89E6;&#x53D1; ACTION_POINTER_UP &#x4E8B;&#x4EF6;&#xFF0C;&#x6700;&#x540E;&#x4E00;&#x6839;&#x624B;&#x6307;&#x7684;&#x62AC;&#x8D77;&#x64CD;&#x4F5C;&#x89E6;&#x53D1; ACTION_UP &#x4E8B;&#x4EF6;&#x3002;</li>
<li>&#x7528;&#x6237;&#x7684;&#x64CD;&#x4F5C;&#x4E0D;&#x4F1A;&#x76F4;&#x63A5;&#x89E6;&#x53D1; ACTION_CANCEL &#x4E8B;&#x4EF6;&#x3002;</li>
<li>&#x4E00;&#x4E2A;&#x5B8C;&#x6574;&#x7684;&#x4E8B;&#x4EF6;&#x6D41;&#x90FD;&#x662F;&#x4EE5; ACTION_DOWN &#x5F00;&#x59CB;&#xFF0C;&#x4EE5; ACTION_UP &#x7ED3;&#x675F;&#x3002;</li>
<li>&#x4E8B;&#x4EF6;&#x7684;&#x4F20;&#x9012;&#x662F;&#x4ECE; <code>Activity.dispatchTouchEvent</code> &#x65B9;&#x6CD5;&#x5F00;&#x59CB;&#xFF0C;&#x5982;&#x679C;&#x4E00;&#x76F4;&#x6CA1;&#x6709;&#x88AB;&#x6D88;&#x8D39;&#xFF0C;&#x6700;&#x540E;&#x4F1A;&#x56DE;&#x5230; <code>Activity.onTouchEvent</code> &#x3002;</li>
</ul>
<h2 id="&#x6E90;&#x7801;&#x89E3;&#x6790;"><a href="#&#x6E90;&#x7801;&#x89E3;&#x6790;" class="headerlink" title="&#x6E90;&#x7801;&#x89E3;&#x6790;"></a>&#x6E90;&#x7801;&#x89E3;&#x6790;</h2><h3 id="view-&#x6E90;&#x7801;&#x89E3;&#x6790;"><a href="#View-&#x6E90;&#x7801;&#x89E3;&#x6790;" class="headerlink" title="View &#x6E90;&#x7801;&#x89E3;&#x6790;"></a>View &#x6E90;&#x7801;&#x89E3;&#x6790;</h3><h4 id="viewontouchevent"><a href="#View-onTouchEvent" class="headerlink" title="View.onTouchEvent"></a>View.onTouchEvent</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">onTouchEvent</span><span class="params">(MotionEvent event)</span> </span>{</span><br><span class="line">    <span class="keyword">final</span> <span class="keyword">int</span> viewFlags = mViewFlags;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> ((viewFlags &amp; ENABLED_MASK) == DISABLED) {    </span><br><span class="line">        <span class="keyword">if</span> (event.getAction() == MotionEvent.ACTION_UP &amp;&amp; (mPrivateFlags &amp; PRESSED) != <span class="number">0</span>) {</span><br><span class="line">          <span class="comment">//&#x5237;&#x65B0;&#x72B6;&#x6001;</span></span><br><span class="line">          mPrivateFlags &amp;= ~PRESSED;</span><br><span class="line">          refreshDrawableState();</span><br><span class="line">        }</span><br><span class="line">        <span class="comment">//&#x4E0D;&#x53EF;&#x7528;&#x4F46;&#x53EF;&#x70B9;&#x51FB;&#x7684;View&#x4F9D;&#x7136;&#x6D88;&#x8D39;&#x89E6;&#x6478;&#x4E8B;&#x4EF6;&#xFF0C;&#x53EA;&#x662F;&#x4E0D;&#x54CD;&#x5E94;&#x800C;&#x5DF2;</span></span><br><span class="line">        <span class="keyword">return</span> (((viewFlags &amp; CLICKABLE) == CLICKABLE ||</span><br><span class="line">            (viewFlags &amp; LONG_CLICKABLE) == LONG_CLICKABLE));</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="comment">//&#x89E6;&#x6478;&#x4E8B;&#x4EF6;&#x4EE3;&#x7406;</span></span><br><span class="line">    <span class="keyword">if</span> (mTouchDelegate != <span class="keyword">null</span>) {</span><br><span class="line">        <span class="keyword">if</span> (mTouchDelegate.onTouchEvent(event)) {</span><br><span class="line">          <span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">        }</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (((viewFlags &amp; CLICKABLE) == CLICKABLE ||</span><br><span class="line">      (viewFlags &amp; LONG_CLICKABLE) == LONG_CLICKABLE)) {</span><br><span class="line">        <span class="keyword">switch</span> (event.getAction()) {</span><br><span class="line">          <span class="comment">//&#x89C1;&#x4E0B;&#x6587;&#x5206;&#x6790;</span></span><br><span class="line">          <span class="keyword">case</span> up,down,cancel,move...</span><br><span class="line">        }</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">    }</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">}</span><br></pre></td></tr></table></figure>
<p>View&#x5BF9;&#x4E8B;&#x4EF6;&#x5904;&#x7406;&#x5206;&#x6790;<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">switch</span></span><br></pre></td></tr></table></figure></p>
<h4 id="viewdispathtouchevent"><a href="#View-DispathTouchEvent" class="headerlink" title="View.DispathTouchEvent"></a>View.DispathTouchEvent</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">dispatchTouchEvent</span><span class="params">(MotionEvent event)</span> </span>{</span><br><span class="line">    <span class="comment">//&#x6D4B;&#x8BD5;&#x4F7F;&#x7528;&#xFF0C;&#x9A8C;&#x8BC1;&#x8F93;&#x5165;&#x4E8B;&#x4EF6;&#x7684;&#x8FDE;&#x7EED;&#x6027;</span></span><br><span class="line">    <span class="keyword">if</span> (mInputEventConsistencyVerifier != <span class="keyword">null</span>) {</span><br><span class="line">        mInputEventConsistencyVerifier.onTouchEvent(event, <span class="number">0</span>);</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="comment">//&#x89E6;&#x6478;&#x4E8B;&#x4EF6;&#x5B89;&#x5168;&#x8FC7;&#x6EE4;</span></span><br><span class="line">    <span class="keyword">if</span> (onFilterTouchEventForSecurity(event)) {</span><br><span class="line">        <span class="keyword">if</span> (mOnTouchListener != <span class="keyword">null</span> &amp;&amp; (mViewFlags &amp; ENABLED_MASK) == ENABLED &amp;&amp;</span><br><span class="line">            mOnTouchListener.onTouch(<span class="keyword">this</span>, event)) {</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">        }</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (onTouchEvent(event)) {</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">        }</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="comment">//&#x6D4B;&#x8BD5;&#x4F7F;&#x7528;&#xFF0C;&#x9A8C;&#x8BC1;&#x8F93;&#x5165;&#x4E8B;&#x4EF6;&#x7684;&#x8FDE;&#x7EED;&#x6027;</span></span><br><span class="line">    <span class="keyword">if</span> (mInputEventConsistencyVerifier != <span class="keyword">null</span>) {</span><br><span class="line">        mInputEventConsistencyVerifier.onUnhandledEvent(event, <span class="number">0</span>);</span><br><span class="line">    }</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">}</span><br></pre></td></tr></table></figure>
<p>&#x4ECE;&#x4EE5;&#x4E0A;&#x6E90;&#x7801;&#x53EF;&#x4EE5;&#x770B;&#x51FA;&#xFF0C;<code>View</code> &#x7684; <code>dispatchTouchEvent</code> &#x65B9;&#x6CD5;&#x53EA;&#x662F;&#x8C03;&#x7528; <code>OnTouchListener</code> &#x6216;&#x8005; <code>onTouchEvent</code> &#x65B9;&#x6CD5;&#x3002;&#x5982;&#x679C; <code>OnTouchListener</code> &#x7684; <code>onTouch()</code> &#x65B9;&#x6CD5;&#x8FD4;&#x56DE; <code>true</code> &#xFF0C;<code>onTouchEvent</code> &#x5C06;&#x4E0D;&#x4F1A;&#x6267;&#x884C;&#x3002;</p>
<h3 id="viewgroup-&#x6E90;&#x7801;&#x5206;&#x6790;"><a href="#ViewGroup-&#x6E90;&#x7801;&#x5206;&#x6790;" class="headerlink" title="ViewGroup &#x6E90;&#x7801;&#x5206;&#x6790;"></a>ViewGroup &#x6E90;&#x7801;&#x5206;&#x6790;</h3><h4 id="viewgroupontouchevent"><a href="#ViewGroup-onTouchEvent" class="headerlink" title="ViewGroup.onTouchEvent"></a>ViewGroup.onTouchEvent</h4><p><code>ViewGroup</code> &#x672A;&#x590D;&#x5199;&#x8BE5;&#x65B9;&#x6CD5;&#xFF0C;&#x4E0E; <code>View</code> &#x884C;&#x4E3A;&#x4E00;&#x81F4;&#x3002;</p>
<h4 id="viewgrouponintercepttoucheevent"><a href="#ViewGroup-onInterceptToucheEvent" class="headerlink" title="ViewGroup.onInterceptToucheEvent"></a>ViewGroup.onInterceptToucheEvent</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">onInterceptTouchEvent</span><span class="params">(MotionEvent ev)</span> </span>{</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">}</span><br></pre></td></tr></table></figure>
<p>&#x9ED8;&#x8BA4;&#x4E0D;&#x62E6;&#x622A;&#x4E8B;&#x4EF6;&#x3002;</p>
<h4 id="viewgroupdispatchtouch"><a href="#ViewGroup-dispatchTouch" class="headerlink" title="ViewGroup.dispatchTouch"></a>ViewGroup.dispatchTouch</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">dispatchTouchEvent</span><span class="params">(MotionEvent ev)</span> </span>{</span><br><span class="line">    <span class="comment">//&#x6D4B;&#x8BD5;&#x4F7F;&#x7528;&#xFF0C;&#x9A8C;&#x8BC1;&#x8F93;&#x5165;&#x4E8B;&#x4EF6;&#x7684;&#x8FDE;&#x7EED;&#x6027;</span></span><br><span class="line">    <span class="keyword">if</span> (mInputEventConsistencyVerifier != <span class="keyword">null</span>) {</span><br><span class="line">        mInputEventConsistencyVerifier.onTouchEvent(ev, <span class="number">1</span>);</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="keyword">boolean</span> handled = <span class="keyword">false</span>;</span><br><span class="line">    <span class="comment">//&#x89E6;&#x6478;&#x4E8B;&#x4EF6;&#x5B89;&#x5168;&#x8FC7;&#x6EE4;</span></span><br><span class="line">    <span class="keyword">if</span> (onFilterTouchEventForSecurity(ev)) {</span><br><span class="line">        <span class="keyword">final</span> <span class="keyword">int</span> action = ev.getAction();</span><br><span class="line">        <span class="keyword">final</span> <span class="keyword">int</span> actionMasked = action &amp; MotionEvent.ACTION_MASK;</span><br><span class="line">        </span><br><span class="line">        <span class="comment">//&#x89E6;&#x6478;&#x4E8B;&#x4EF6;&#x4EE5;action_down&#x4E3A;&#x5F00;&#x7AEF;&#xFF0C;&#x9700;&#x8981;&#x8FDB;&#x884C;&#x6E05;&#x9664; TouchTarget &#x8BB0;&#x5F55;&#x3001;&#x91CD;&#x7F6E;&#x5F53;&#x524D; ViewGroup &#x89E6;&#x6478;&#x72B6;&#x6001;</span></span><br><span class="line">        <span class="comment">// Handle an initial down.</span></span><br><span class="line">        <span class="keyword">if</span> (actionMasked == MotionEvent.ACTION_DOWN) {</span><br><span class="line">            <span class="comment">// Throw away all previous state when starting a new touch gesture.</span></span><br><span class="line">            <span class="comment">// The framework may have dropped the up or cancel event for the previous gesture</span></span><br><span class="line">            <span class="comment">// due to an app switch, ANR, or some other state change.</span></span><br><span class="line">            cancelAndClearTouchTargets(ev);</span><br><span class="line">            resetTouchState();</span><br><span class="line">        }</span><br><span class="line">        </span><br><span class="line">        <span class="comment">//&#x5224;&#x65AD;&#x662F;&#x5426;&#x62E6;&#x622A;&#xFF0C;&#x7ED3;&#x679C;&#x4FDD;&#x5B58;&#x5728;intercepted&#x53D8;&#x91CF;&#x4E2D;</span></span><br><span class="line">        <span class="comment">//mFirstTouchTarget&#x5B58;&#x7591;</span></span><br><span class="line">        <span class="comment">// Check for interception.</span></span><br><span class="line">        <span class="keyword">final</span> <span class="keyword">boolean</span> intercepted;</span><br><span class="line">        <span class="keyword">if</span> (actionMasked == MotionEvent.ACTION_DOWN</span><br><span class="line">                || mFirstTouchTarget != <span class="keyword">null</span>) {</span><br><span class="line">            <span class="keyword">final</span> <span class="keyword">boolean</span> disallowIntercept = (mGroupFlags &amp; FLAG_DISALLOW_INTERCEPT) != <span class="number">0</span>;</span><br><span class="line">            <span class="keyword">if</span> (!disallowIntercept) {</span><br><span class="line">                intercepted = onInterceptTouchEvent(ev);</span><br><span class="line">                ev.setAction(action); <span class="comment">// restore action in case it was changed</span></span><br><span class="line">            } <span class="keyword">else</span> {</span><br><span class="line">                intercepted = <span class="keyword">false</span>;</span><br><span class="line">            }</span><br><span class="line">        } <span class="keyword">else</span> {</span><br><span class="line">            <span class="comment">//&#x4E0D;&#x662F; action_down &#x4E8B;&#x4EF6;&#x4E14;&#x6CA1;&#x6709;&#x76EE;&#x6807; View&#xFF0C;`ViewGroup` &#x53EA;&#x597D;&#x4EA4;&#x7ED9;&#x81EA;&#x5DF1;&#x5904;&#x7406;&#x3002;&#x89C1;&#x6D4B;&#x8BD5;&#x56DB;</span></span><br><span class="line">            <span class="comment">// There are no touch targets and this action is not an initial down</span></span><br><span class="line">            <span class="comment">// so this view group continues to intercept touches.</span></span><br><span class="line">            intercepted = <span class="keyword">true</span>;</span><br><span class="line">        }</span><br><span class="line"></span><br><span class="line">        <span class="comment">/** &#x68C0;&#x67E5;&#x662F;&#x5426;&#x53D6;&#x6D88;&#x4E8B;&#x4EF6;&#x4F20;&#x9012;</span><br><span class="line">        *   1&#x3001;&#x8BE5; View &#x88AB;&#x79FB;&#x9664;&#x3002;resetCancelNextUpFlag() &#x5185;&#x90E8;&#x5224;&#x65AD;&#x5E76;&#x91CD;&#x7F6E;</span><br><span class="line">        *   View.CANCEL_NEXT_UP_EVENT &#x6807;&#x5FD7;&#x4F4D;&#x3002;&#x8BE5;&#x6807;&#x5FD7;&#x6807;&#x8BC6; View &#x88AB;&#x4E34;&#x65F6;&#x79FB;&#x9664;&#x3002;</span><br><span class="line">        *   2&#x3001;&#x6536;&#x5230; action_cancel &#x4E8B;&#x4EF6;</span><br><span class="line">        */</span></span><br><span class="line">        <span class="comment">// Check for cancelation.</span></span><br><span class="line">        <span class="keyword">final</span> <span class="keyword">boolean</span> canceled = resetCancelNextUpFlag(<span class="keyword">this</span>)</span><br><span class="line">                || actionMasked == MotionEvent.ACTION_CANCEL;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// Update list of touch targets for pointer down, if needed.</span></span><br><span class="line">        <span class="keyword">final</span> <span class="keyword">boolean</span> split = (mGroupFlags &amp; FLAG_SPLIT_MOTION_EVENTS) != <span class="number">0</span>;</span><br><span class="line">        TouchTarget newTouchTarget = <span class="keyword">null</span>;</span><br><span class="line">        <span class="keyword">boolean</span> alreadyDispatchedToNewTouchTarget = <span class="keyword">false</span>;</span><br><span class="line">        <span class="comment">//&#x672A;&#x53D6;&#x6D88;&#x4E8B;&#x4EF6;&#x4E14;&#x4E0D;&#x62E6;&#x622A;</span></span><br><span class="line">        <span class="keyword">if</span> (!canceled &amp;&amp; !intercepted) {</span><br><span class="line">            <span class="comment">//action_down&#x4E8B;&#x4EF6;</span></span><br><span class="line">            <span class="keyword">if</span> (actionMasked == MotionEvent.ACTION_DOWN</span><br><span class="line">                    <span class="comment">//action_pointer_down&#x591A;&#x70B9;&#x89E6;&#x6478;&#x4E2D;&#xFF0C;&#x7B2C;&#x4E00;&#x4E2A;&#x70B9;&#x4E4B;&#x540E;&#x7684;&#x6309;&#x4E0B;&#x4E8B;&#x4EF6;</span></span><br><span class="line">                    || (split &amp;&amp; actionMasked == MotionEvent.ACTION_POINTER_DOWN)</span><br><span class="line">                    <span class="comment">//&#x9F20;&#x6807;&#x60AC;&#x505C;&#x4E8B;&#x4EF6;</span></span><br><span class="line">                    || actionMasked == MotionEvent.ACTION_HOVER_MOVE) {</span><br><span class="line">                <span class="keyword">final</span> <span class="keyword">int</span> actionIndex = ev.getActionIndex(); <span class="comment">// always 0 for down</span></span><br><span class="line">                <span class="keyword">final</span> <span class="keyword">int</span> idBitsToAssign = split ? <span class="number">1</span> &lt;&lt; ev.getPointerId(actionIndex)</span><br><span class="line">                        : TouchTarget.ALL_POINTER_IDS;</span><br><span class="line">                </span><br><span class="line">                <span class="comment">//&#x8FD9;&#x662F;&#x4E00;&#x4E2A;&#x65B0;&#x7684;&#x201C;&#x6309;&#x4E0B;&#x201D;&#x4E8B;&#x4EF6;&#xFF0C;&#x6E05;&#x9664; TouchTarget &#x4E4B;&#x524D;&#x5173;&#x8054;&#x7684; point id</span></span><br><span class="line">                <span class="comment">//&#x6709;&#x53EF;&#x80FD; point id &#x91CD;&#x590D;&#xFF0C;&#x4F46;&#x73B0;&#x5728;&#x662F;&#x5168;&#x65B0;&#x7684;&#x4E8B;&#x4EF6;</span></span><br><span class="line">                <span class="comment">// Clean up earlier touch targets for this pointer id in case they</span></span><br><span class="line">                <span class="comment">// have become out of sync.</span></span><br><span class="line">                removePointersFromTouchTargets(idBitsToAssign);</span><br><span class="line"></span><br><span class="line">                <span class="keyword">final</span> <span class="keyword">int</span> childrenCount = mChildrenCount;</span><br><span class="line">                <span class="keyword">if</span> (childrenCount != <span class="number">0</span>) {</span><br><span class="line">                    <span class="comment">// Find a child that can receive the event.</span></span><br><span class="line">                    <span class="comment">// Scan children from front to back.</span></span><br><span class="line">                    <span class="keyword">final</span> View[] children = mChildren;</span><br><span class="line">                    <span class="keyword">final</span> <span class="keyword">float</span> x = ev.getX(actionIndex);</span><br><span class="line">                    <span class="keyword">final</span> <span class="keyword">float</span> y = ev.getY(actionIndex);</span><br><span class="line">                    <span class="comment">//&#x904D;&#x5386;&#x5B50;iew&#xFF0C;&#x627E;&#x5230;&#x63A5;&#x6536; action_down &#x7684; View</span></span><br><span class="line">                    <span class="keyword">for</span> (<span class="keyword">int</span> i = childrenCount - <span class="number">1</span>; i &gt;= <span class="number">0</span>; i--) {</span><br><span class="line">                        <span class="comment">//&#x6B64;&#x5904;&#x5173;&#x4E8E;&#x5B50; View &#x7684;&#x904D;&#x5386;&#x987A;&#x5E8F;&#x5404;&#x7248;&#x672C;&#x4E0D;&#x4E00;&#x81F4;</span></span><br><span class="line">                        <span class="comment">//&#x4E4B;&#x540E;&#x7684;&#x7248;&#x672C;&#x517C;&#x987E;&#x5230; getChildDrawingOrder &#x65B9;&#x6CD5;</span></span><br><span class="line">                        <span class="keyword">final</span> View child = children[i];</span><br><span class="line">                        <span class="comment">//&#x8BE5; View &#x4E0D;&#x53EF;&#x4EE5;&#x63A5;&#x53D7;&#x4E8B;&#x4EF6;&#x6216;&#x8005;&#x89E6;&#x6478;&#x70B9;&#x5728;&#x8BE5; View &#x8303;&#x56F4;&#x5916;&#xFF0C;&#x8DF3;&#x8FC7;&#x8BE5; View</span></span><br><span class="line">                        <span class="comment">//&#x53EF;&#x4EE5;&#x63A5;&#x53D7;&#x89E6;&#x6478;&#x4E8B;&#x4EF6;&#x7684;&#x6761;&#x4EF6;&#xFF1A;1&#x3001;&#x53EF;&#x89C1; 2&#x3001;&#x4E0D;&#x53EF;&#x89C1;&#x4F46;&#x662F;&#x5728;&#x6267;&#x884C;&#x52A8;&#x753B;</span></span><br><span class="line">                        <span class="keyword">if</span> (!canViewReceivePointerEvents(child)</span><br><span class="line">                                || !isTransformedTouchPointInView(x, y, child, <span class="keyword">null</span>)) {</span><br><span class="line">                            <span class="keyword">continue</span>;</span><br><span class="line">                        }</span><br><span class="line">                        <span class="comment">//&#x5728; mFirstTouchTarget &#x5355;&#x94FE;&#x8868;&#x4E2D;&#x5BFB;&#x627E;&#x4EE3;&#x8868;&#x8BE5; View &#x7684; TouchTarget</span></span><br><span class="line">                        newTouchTarget = getTouchTarget(child);</span><br><span class="line">                        <span class="keyword">if</span> (newTouchTarget != <span class="keyword">null</span>) {</span><br><span class="line">                            <span class="comment">/** &#x8BE5; View &#x5DF2;&#x7ECF;&#x5728; mFirstTouchTarget &#x4E2D;,&#x5C06;&#x65B0;&#x7684;&#x89E6;&#x6478;&#x70B9;&#x6DFB;&#x52A0;&#x7ED9;</span><br><span class="line">                             *  &#x8BE5;TouchTarget</span><br><span class="line">                             */</span></span><br><span class="line">                            <span class="comment">// Child is already receiving touch within its bounds.</span></span><br><span class="line">                            <span class="comment">// Give it the new pointer in addition to the ones it is handling.</span></span><br><span class="line">                            newTouchTarget.pointerIdBits |= idBitsToAssign;</span><br><span class="line">                            <span class="comment">//&#x5DF2;&#x627E;&#x5230;&#x89E6;&#x6478;&#x4E8B;&#x4EF6;&#x76EE;&#x6807; View &#xFF0C;&#x8DF3;&#x51FA;&#x8BE5;&#x5FAA;&#x73AF;</span></span><br><span class="line">                            <span class="keyword">break</span>;</span><br><span class="line">                        }</span><br><span class="line">                        </span><br><span class="line">                        <span class="comment">//&#x91CD;&#x7F6E; child &#x7684; PFLAG_CANCEL_NEXT_UP_EVENT &#x4F4D;</span></span><br><span class="line">                        <span class="comment">//&#x4E3A;&#x4EC0;&#x4E48;&#x8981;&#x91CD;&#x7F6E;&#x8FD9;&#x4E2A;&#x554A;&#xFF1F;&#xFF1F;&#xFF1F;</span></span><br><span class="line">                        <span class="comment">//&#x8BE5;&#x6807;&#x5FD7;&#x6807;&#x8BC6; View &#x88AB;&#x4E34;&#x65F6;&#x79FB;&#x9664;&#xFF0C;&#x8DDF;&#x89E6;&#x6478;&#x4E8B;&#x4EF6;&#x6709;&#x4EC0;&#x4E48;&#x5173;&#x7CFB;&#x554A;</span></span><br><span class="line">                        resetCancelNextUpFlag(child);</span><br><span class="line">                        </span><br><span class="line">                        <span class="comment">/**</span><br><span class="line">                         * &#x6267;&#x884C;&#x5230;&#x8FD9;&#x91CC;&#x8BF4;&#x660E;&#x627E;&#x5230;&#x4E86;&#x4E00;&#x4E2A; child view &#x6EE1;&#x8DB3;&#x4EE5;&#x4E0B;&#x6761;&#x4EF6;:</span><br><span class="line">                         *  1&#x3001;&#x53EF;&#x4EE5;&#x63A5;&#x53D7;&#x89E6;&#x6478;&#x4E8B;&#x4EF6;</span><br><span class="line">                         *  2&#x3001;&#x89E6;&#x6478;&#x70B9;&#x5728;&#x8BE5; View &#x533A;&#x57DF;&#x5185;</span><br><span class="line">                         *  3&#x3001;&#x672A;&#x88AB; mFirstTouchTarget &#x8BB0;&#x5F55;</span><br><span class="line">                         *</span><br><span class="line">                         *  action_down &#x4E8B;&#x4EF6;&#x53D1;&#x751F;&#x65F6;&#xFF0C;&#x4E00;&#x5B9A;&#x4F1A;&#x6267;&#x884C;&#x5230;&#x8FD9;&#x91CC;</span><br><span class="line">                         *  </span><br><span class="line">                         *  &#x53EA;&#x6709;&#x6EE1;&#x8DB3;&#x524D;&#x4E24;&#x4E2A;&#x6761;&#x4EF6;&#x7684; View &#x624D;&#x6709;&#x53EF;&#x80FD;&#x6210;&#x4E3A; target View&#x3002;</span><br><span class="line">                         *  &#x8981;&#x60F3;&#x771F;&#x6B63;&#x6210;&#x4E3A; target view &#xFF0C;&#x8FD8;&#x5FC5;&#x987B;&#x81EA;&#x5DF1;&#x58F0;&#x660E;&#x5BF9;&#x8BE5;&#x89E6;&#x6478;&#x4E8B;&#x4EF6;&#x611F;&#x5174;&#x8DA3;&#x3002;</span><br><span class="line">                         *</span><br><span class="line">                         *  &#x4E0B;&#x9762;&#x7684;if&#x8BED;&#x53E5;&#x7684;&#x4F5C;&#x7528;&#x5C31;&#x662F;&#x5224;&#x65AD;&#x8BE5; child view &#x662F;&#x5426;&#x5BF9;&#x8BE5;&#x89E6;&#x6478;&#x4E8B;&#x4EF6;&#x611F;&#x5174;&#x8DA3;</span><br><span class="line">                         */</span></span><br><span class="line">                        <span class="comment">// dispatchTransformedTouchEvent &#x5206;&#x6790;&#x89C1;&#x4E0B;&#x6587;</span></span><br><span class="line">                        <span class="keyword">if</span> (dispatchTransformedTouchEvent(ev, <span class="keyword">false</span>, child, idBitsToAssign)) {</span><br><span class="line">                            <span class="comment">// child view &#x5BF9;&#x8BE5;&#x89E6;&#x6478;&#x4E8B;&#x4EF6;&#x611F;&#x5174;&#x8DA3;</span></span><br><span class="line">                            <span class="comment">// Child wants to receive touch within its bounds.</span></span><br><span class="line">                            mLastTouchDownTime = ev.getDownTime();</span><br><span class="line">                            mLastTouchDownIndex = i;</span><br><span class="line">                            mLastTouchDownX = ev.getX();</span><br><span class="line">                            mLastTouchDownY = ev.getY();</span><br><span class="line">                            <span class="comment">//&#x6DFB;&#x52A0;&#x5230; mFirstTouchTarget &#x5355;&#x94FE;&#x8868;&#x5934;&#x90E8;</span></span><br><span class="line">                            newTouchTarget = addTouchTarget(child, idBitsToAssign);</span><br><span class="line">                            <span class="comment">//&#x4E3A;&#x4E86;&#x6D4B;&#x8BD5; View &#x662F;&#x5426;&#x5BF9;&#x89E6;&#x6478;&#x4E8B;&#x4EF6;&#x611F;&#x5174;&#x8DA3;&#xFF0C;&#x8BE5;&#x89E6;&#x6478;&#x4E8B;&#x4EF6;&#x5DF2;&#x7ECF;&#x53D1;&#x7ED9; target view &#x4E86;</span></span><br><span class="line">                            alreadyDispatchedToNewTouchTarget = <span class="keyword">true</span>;</span><br><span class="line">                            <span class="comment">//&#x627E;&#x5230;&#x4E86; target view &#x8DF3;&#x51FA; for &#x5FAA;&#x73AF;</span></span><br><span class="line">                            <span class="keyword">break</span>;</span><br><span class="line">                        }</span><br><span class="line">                    }</span><br><span class="line">                }</span><br><span class="line">                </span><br><span class="line">                <span class="comment">//&#x6CA1;&#x6709;&#x627E;&#x5230;&#x65B0;&#x7684;&#x76EE;&#x6807; View &#xFF0C;&#x5C31;&#x662F;&#x7528;&#x4E0A;&#x6B21;&#x7684;</span></span><br><span class="line">                <span class="comment">//&#x4E3A;&#x4EC0;&#x4E48;&#x8981;&#x8FD9;&#x4E48;&#x505A;&#x554A;&#xFF0C;&#x6CA1;&#x627E;&#x5230;&#x5C31;&#x4E0D;&#x5206;&#x53D1;&#x4E86;&#x5457;&#xFF1F;&#xFF1F;&#xFF1F;</span></span><br><span class="line">                <span class="keyword">if</span> (newTouchTarget == <span class="keyword">null</span> &amp;&amp; mFirstTouchTarget != <span class="keyword">null</span>) {</span><br><span class="line">                    <span class="comment">// &#x5C06; newTouchTarget &#x7F6E;&#x4E3A; mFirstTouchTarget &#x6700;&#x540E;&#x4E0D;&#x4E3A;&#x7A7A;&#x7684;&#x8282;&#x70B9;</span></span><br><span class="line">                    <span class="comment">// Did not find a child to receive the event.</span></span><br><span class="line">                    <span class="comment">// Assign the pointer to the least recently added target.</span></span><br><span class="line">                    newTouchTarget = mFirstTouchTarget;</span><br><span class="line">                    <span class="keyword">while</span> (newTouchTarget.next != <span class="keyword">null</span>) {</span><br><span class="line">                        newTouchTarget = newTouchTarget.next;</span><br><span class="line">                    }</span><br><span class="line">                    newTouchTarget.pointerIdBits |= idBitsToAssign;</span><br><span class="line">                }</span><br><span class="line">            }</span><br><span class="line">        }</span><br><span class="line">        <span class="comment">//&#x524D;&#x9762;&#x5BFB;&#x627E; target view&#xFF0C;&#x4E0B;&#x9762;&#x8FDB;&#x884C;&#x5206;&#x53D1;</span></span><br><span class="line">        <span class="comment">// Dispatch to touch targets.</span></span><br><span class="line">        <span class="keyword">if</span> (mFirstTouchTarget == <span class="keyword">null</span>) {</span><br><span class="line">            <span class="comment">/*  &#x6CA1;&#x627E;&#x5230; target view ,&#x4E5F;&#x5C31;&#x662F; child view &#x4E0D;&#x6D88;&#x8017;&#x4E8B;&#x4EF6;&#xFF0C;&#x6B64;&#x65F6;&#x624D;&#x628A;&#x4E8B;&#x4EF6;&#x4EA4;&#x7ED9;&#x81EA;&#x5DF1;&#x5904;&#x7406;</span><br><span class="line">             *  &#x800C;&#x4E14;&#xFF0C;&#x53EA;&#x6709;&#x5728;&#x53D1;&#x751F; action_down,action_pointer_down &#x6216;&#x8005; action_hover_move &#x65F6;&#x624D;&#x5BFB;&#x627E;</span><br><span class="line">             *  target view&#x3002;&#x4E5F;&#x5C31;&#x662F;&#x8BF4;,&#x5982;&#x679C; view &#x4E0D;&#x6D88;&#x8D39;&#x8FD9;&#x4E09;&#x4E2A;&#x4E8B;&#x4EF6;&#x4E4B;&#x4E00;&#x5C31;&#x6CA1;&#x6709;&#x673A;&#x4F1A;&#x6210;&#x4E3A; target view&#xFF0C;</span><br><span class="line">             *  &#x4E5F;&#x5C31;&#x6CA1;&#x673A;&#x4F1A;&#x6536;&#x5230;&#x4E4B;&#x540E;&#x7684;&#x4E8B;&#x4EF6;</span><br><span class="line">             *</span><br><span class="line">             *  &#x7B2C;&#x4E09;&#x4E2A;&#x53C2;&#x6570;&#x4E3A;&#x7A7A;&#xFF0C;&#x5177;&#x4F53;&#x65B9;&#x6CD5;&#x5B9E;&#x73B0;&#x4F1A;&#x8C03;&#x7528; View.dispatchTouchEvent&#x65B9;&#x6CD5;&#x3002;</span><br><span class="line">             *  &#x800C;View.dispatchTouchEvent&#x53EA;&#x4F1A;&#x8C03;&#x7528;onTouchListener </span><br><span class="line">             *  &#x6216;&#x8005; onTouchEvent &#x65B9;&#x6CD5;&#x5904;&#x7406;</span><br><span class="line">             *  </span><br><span class="line">             *  &#x6B64;&#x5904;&#x4E5F;&#x5C31;&#x8BF4;&#x660E;&#x4E86;&#xFF0C;&#x53EA;&#x6709; child view &#x4E0D;&#x6D88;&#x8D39;&#x4E8B;&#x4EF6;&#x540E;&#xFF0C;&#x4E8B;&#x4EF6;&#x624D;&#x4F1A;&#x4F20;&#x9012;&#x7ED9;&#x4E0A;&#x5C42; ViewGroup</span><br><span class="line">             *  &#x7684; onTouchEvent</span><br><span class="line">             */</span></span><br><span class="line">            <span class="comment">// No touch targets so treat this as an ordinary view.</span></span><br><span class="line">            handled = dispatchTransformedTouchEvent(ev, canceled, <span class="keyword">null</span>,</span><br><span class="line">                    TouchTarget.ALL_POINTER_IDS);</span><br><span class="line">        } <span class="keyword">else</span> {</span><br><span class="line">            <span class="comment">// Dispatch to touch targets, excluding the new touch target if we already</span></span><br><span class="line">            <span class="comment">// dispatched to it.  Cancel touch targets if necessary.</span></span><br><span class="line">            TouchTarget predecessor = <span class="keyword">null</span>;</span><br><span class="line">            TouchTarget target = mFirstTouchTarget;</span><br><span class="line">            <span class="keyword">while</span> (target != <span class="keyword">null</span>) {</span><br><span class="line">                <span class="keyword">final</span> TouchTarget next = target.next;</span><br><span class="line">                <span class="keyword">if</span> (alreadyDispatchedToNewTouchTarget &amp;&amp; target == newTouchTarget) {</span><br><span class="line">                    handled = <span class="keyword">true</span>;</span><br><span class="line">                } <span class="keyword">else</span> {</span><br><span class="line">                    <span class="keyword">final</span> <span class="keyword">boolean</span> cancelChild = resetCancelNextUpFlag(target.child)</span><br><span class="line">                    || intercepted;</span><br><span class="line">                    <span class="comment">//&#x6B64;&#x5904;&#x5C31;&#x662F;&#x5F53; ViewGroup &#x51B3;&#x5B9A;&#x62E6;&#x622A;&#x4E8B;&#x4EF6;&#x65F6;&#xFF0C;&#x4F20;&#x9012; action_cancle &#x4E8B;&#x4EF6;&#x7ED9; child view&#x3002;</span></span><br><span class="line">                    <span class="keyword">if</span> (dispatchTransformedTouchEvent(ev, cancelChild,</span><br><span class="line">                            target.child, target.pointerIdBits)) {</span><br><span class="line">                        handled = <span class="keyword">true</span>;</span><br><span class="line">                    }</span><br><span class="line">                    <span class="keyword">if</span> (cancelChild) {</span><br><span class="line">                        <span class="comment">/** &#x5982;&#x679C; intercepted &#x4E3A; true &#xFF0C;&#x4ECE;&#x5934;&#x5230;&#x5C3E;&#x9500;&#x6BC1; mFirstTouchTarget</span><br><span class="line">                         *  &#x5982;&#x679C; intercepted &#x4E3A; false&#xFF0C;&#x53EA;&#x9500;&#x6BC1; target &#xFF0C;&#x800C; predecessor</span><br><span class="line">                         *  &#x5C31;&#x662F;&#x4E3A;&#x4E86;&#x5B9E;&#x73B0;&#x5355;&#x94FE;&#x8868;&#x7684;&#x5220;&#x9664;&#x64CD;&#x4F5C;&#xFF0C;&#x6307;&#x5411; target &#x524D;&#x4E00;&#x4E2A;&#x5143;&#x7D20;&#x7684;&#x5F15;&#x7528;</span><br><span class="line">                         */</span></span><br><span class="line">                         <span class="comment">//&#x4E5F;&#x5C31;&#x8BF4;&#x660E;&#x4E86;&#xFF0C;&#x5F53; ViewGroup &#x62E6;&#x622A;&#x4E8B;&#x4EF6;&#x540E;&#xFF0C;&#x6240;&#x6709;&#x7684;&#x4E8B;&#x4EF6;&#x4E0D;&#x518D;&#x5206;&#x53D1;&#x3002;child view</span></span><br><span class="line">                         <span class="comment">//&#x53EA;&#x4F1A;&#x6536;&#x5230; action_cancle &#x4E8B;&#x4EF6;</span></span><br><span class="line">                        <span class="keyword">if</span> (predecessor == <span class="keyword">null</span>) {</span><br><span class="line">                            mFirstTouchTarget = next;</span><br><span class="line">                        } <span class="keyword">else</span> {</span><br><span class="line">                            predecessor.next = next;</span><br><span class="line">                        }</span><br><span class="line">                        target.recycle();</span><br><span class="line">                        target = next;</span><br><span class="line">                        <span class="keyword">continue</span>;</span><br><span class="line">                    }</span><br><span class="line">                }</span><br><span class="line">                predecessor = target;</span><br><span class="line">                target = next;</span><br><span class="line">            }</span><br><span class="line">        }</span><br><span class="line">        </span><br><span class="line">        <span class="comment">//&#x66F4;&#x65B0;&#x72B6;&#x6001;</span></span><br><span class="line">        <span class="comment">// Update list of touch targets for pointer up or cancel, if needed.</span></span><br><span class="line">        <span class="keyword">if</span> (canceled</span><br><span class="line">                || actionMasked == MotionEvent.ACTION_UP</span><br><span class="line">                || actionMasked == MotionEvent.ACTION_HOVER_MOVE) {</span><br><span class="line">            resetTouchState();</span><br><span class="line">        } <span class="keyword">else</span> <span class="keyword">if</span> (split &amp;&amp; actionMasked == MotionEvent.ACTION_POINTER_UP) {</span><br><span class="line">            <span class="comment">// &#x624B;&#x6307;&#x62AC;&#x8D77;&#x4E8B;&#x4EF6;</span></span><br><span class="line">            <span class="keyword">final</span> <span class="keyword">int</span> actionIndex = ev.getActionIndex();</span><br><span class="line">            <span class="keyword">final</span> <span class="keyword">int</span> idBitsToRemove = <span class="number">1</span> &lt;&lt; ev.getPointerId(actionIndex);</span><br><span class="line">            removePointersFromTouchTargets(idBitsToRemove);</span><br><span class="line">        }</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="comment">//&#x6D4B;&#x8BD5;&#x4F7F;&#x7528;&#xFF0C;&#x9A8C;&#x8BC1;&#x8F93;&#x5165;&#x4E8B;&#x4EF6;&#x7684;&#x8FDE;&#x7EED;&#x6027;</span></span><br><span class="line">    <span class="keyword">if</span> (!handled &amp;&amp; mInputEventConsistencyVerifier != <span class="keyword">null</span>) {</span><br><span class="line">        mInputEventConsistencyVerifier.onUnhandledEvent(ev, <span class="number">1</span>);</span><br><span class="line">    }</span><br><span class="line">    <span class="keyword">return</span> handled;</span><br><span class="line">}</span><br></pre></td></tr></table></figure>
<p>&#x4E0B;&#x9762;&#x5206;&#x6790; <code>dispatchTransformedTouchEvent</code><br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">boolean</span> <span class="title">dispatchTransformedTouchEvent</span><span class="params">(MotionEvent event, <span class="keyword">boolean</span> cancel,</span><br><span class="line">           View child, <span class="keyword">int</span> desiredPointerIdBits)</span> </span>{</span><br><span class="line">    <span class="keyword">final</span> <span class="keyword">boolean</span> handled;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//&#x5206;&#x53D1; action_cancle &#x4E8B;&#x4EF6;</span></span><br><span class="line">    <span class="comment">// Canceling motions is a special case.  We don&apos;t need to perform any transformations</span></span><br><span class="line">    <span class="comment">// or filtering.  The important part is the action, not the contents.</span></span><br><span class="line">    <span class="keyword">final</span> <span class="keyword">int</span> oldAction = event.getAction();</span><br><span class="line">    <span class="keyword">if</span> (cancel || oldAction == MotionEvent.ACTION_CANCEL) {</span><br><span class="line">       event.setAction(MotionEvent.ACTION_CANCEL);</span><br><span class="line">       <span class="keyword">if</span> (child == <span class="keyword">null</span>) {</span><br><span class="line">           <span class="comment">/** super.dispatch &#x5373; View.dispatch &#x65B9;&#x6CD5;&#xFF0C;&#x5373;&#x4EA4;&#x7ED9;&#x5F53;&#x524D; ViewGroup &#x7684; onTouchListener </span><br><span class="line">            *  &#x6216;&#x8005; onTouchEvent &#x65B9;&#x6CD5;&#x5904;&#x7406;</span><br><span class="line">            */</span></span><br><span class="line">           handled = <span class="keyword">super</span>.dispatchTouchEvent(event);</span><br><span class="line">       } <span class="keyword">else</span> {</span><br><span class="line">           <span class="comment">//&#x5B50; view &#x5904;&#x7406;&#x8BE5;&#x4E8B;&#x4EF6;</span></span><br><span class="line">           handled = child.dispatchTouchEvent(event);</span><br><span class="line">       }</span><br><span class="line">       event.setAction(oldAction);</span><br><span class="line">       <span class="keyword">return</span> handled;</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Calculate the number of pointers to deliver.</span></span><br><span class="line">    <span class="keyword">final</span> <span class="keyword">int</span> oldPointerIdBits = event.getPointerIdBits();</span><br><span class="line">    <span class="keyword">final</span> <span class="keyword">int</span> newPointerIdBits = oldPointerIdBits &amp; desiredPointerIdBits;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// If for some reason we ended up in an inconsistent state where it looks like we</span></span><br><span class="line">    <span class="comment">// might produce a motion event with no pointers in it, then drop the event.</span></span><br><span class="line">    <span class="keyword">if</span> (newPointerIdBits == <span class="number">0</span>) {</span><br><span class="line">       <span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="comment">// If the number of pointers is the same and we don&apos;t need to perform any fancy</span></span><br><span class="line">    <span class="comment">// irreversible transformations, then we can reuse the motion event for this</span></span><br><span class="line">    <span class="comment">// dispatch as long as we are careful to revert any changes we make.</span></span><br><span class="line">    <span class="comment">// Otherwise we need to make a copy.</span></span><br><span class="line">    <span class="keyword">final</span> MotionEvent transformedEvent;</span><br><span class="line">    <span class="keyword">if</span> (newPointerIdBits == oldPointerIdBits) {</span><br><span class="line">       <span class="comment">//&#x524D;&#x540E;id&#x76F8;&#x540C;&#xFF0C;&#x4E0D;&#x9700;&#x8981;&#x8F6C;&#x6362;&#xFF0C;&#x76F4;&#x63A5;&#x8FDB;&#x884C;&#x5206;&#x53D1;</span></span><br><span class="line">       <span class="comment">//&#x77E5;&#x9053;&#x662F;&#x4EC0;&#x4E48;&#xFF0C;&#x4F46;&#x662F;&#x4E0D;&#x77E5;&#x9053;&#x4E3A;&#x4EC0;&#x4E48;&#xFF1F;&#xFF1F;&#xFF1F;</span></span><br><span class="line">       <span class="keyword">if</span> (child == <span class="keyword">null</span> || child.hasIdentityMatrix()) {</span><br><span class="line">           <span class="keyword">if</span> (child == <span class="keyword">null</span>) {</span><br><span class="line">               handled = <span class="keyword">super</span>.dispatchTouchEvent(event);</span><br><span class="line">           } <span class="keyword">else</span> {</span><br><span class="line">               <span class="comment">//</span></span><br><span class="line">               <span class="keyword">final</span> <span class="keyword">float</span> offsetX = mScrollX - child.mLeft;</span><br><span class="line">               <span class="keyword">final</span> <span class="keyword">float</span> offsetY = mScrollY - child.mTop;</span><br><span class="line">               event.offsetLocation(offsetX, offsetY);</span><br><span class="line"></span><br><span class="line">               handled = child.dispatchTouchEvent(event);</span><br><span class="line"></span><br><span class="line">               event.offsetLocation(-offsetX, -offsetY);</span><br><span class="line">            }</span><br><span class="line">            <span class="keyword">return</span> handled;</span><br><span class="line">        }</span><br><span class="line">        transformedEvent = MotionEvent.obtain(event);</span><br><span class="line">    } <span class="keyword">else</span> {</span><br><span class="line">        transformedEvent = event.split(newPointerIdBits);</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="comment">//&#x8F6C;&#x6362;&#x548C;&#x5206;&#x53D1;</span></span><br><span class="line">    <span class="comment">// Perform any necessary transformations and dispatch.</span></span><br><span class="line">    <span class="keyword">if</span> (child == <span class="keyword">null</span>) {</span><br><span class="line">        handled = <span class="keyword">super</span>.dispatchTouchEvent(transformedEvent);</span><br><span class="line">    } <span class="keyword">else</span> {</span><br><span class="line">        <span class="keyword">final</span> <span class="keyword">float</span> offsetX = mScrollX - child.mLeft;</span><br><span class="line">        <span class="keyword">final</span> <span class="keyword">float</span> offsetY = mScrollY - child.mTop;</span><br><span class="line">        transformedEvent.offsetLocation(offsetX, offsetY);</span><br><span class="line">        <span class="keyword">if</span> (! child.hasIdentityMatrix()) {</span><br><span class="line">            transformedEvent.transform(child.getInverseMatrix());</span><br><span class="line">        }</span><br><span class="line"></span><br><span class="line">        handled = child.dispatchTouchEvent(transformedEvent);</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Done.</span></span><br><span class="line">    transformedEvent.recycle();</span><br><span class="line">    <span class="keyword">return</span> handled;</span><br><span class="line">}</span><br></pre></td></tr></table></figure></p>
<p><code>ViewGroup</code> &#x7684;&#x4E8B;&#x4EF6;&#x5206;&#x53D1;&#x5206;&#x4E3A;&#x5982;&#x4E0B;&#x51E0;&#x4E2A;&#x6B65;&#x9AA4;&#xFF1A;  </p>
<ol>
<li>&#x5982;&#x679C;&#x662F; <code>action_down</code> &#x4E8B;&#x4EF6;&#xFF0C;&#x6E05;&#x9664; <code>mFirstTouchTarget</code> &#x5E76;&#x91CD;&#x7F6E;&#x89E6;&#x6478;&#x72B6;&#x6001;&#x3002;</li>
<li>&#x5224;&#x65AD;&#x662F;&#x5426;&#x62E6;&#x622A;&#x8BE5;&#x4E8B;&#x4EF6;&#x3002;&#x5982;&#x679C;&#x662F; <code>action_down</code> &#x6216;&#x8005;&#x5DF2;&#x627E;&#x5230; <code>mFirstTouchTarget</code> &#x5E76;&#x4E14;&#x5141;&#x8BB8;&#x4E8B;&#x4EF6;&#x62E6;&#x622A;&#x65F6;&#xFF0C;&#x4F1A;&#x8C03;&#x7528; <code>onInterceptTouchEvent</code> &#x65B9;&#x6CD5;&#x3002;</li>
<li>&#x5224;&#x65AD;&#x662F;&#x5426;&#x53D6;&#x6D88;&#x4E8B;&#x4EF6;&#x3002;</li>
<li>&#x5BFB;&#x627E;&#x76EE;&#x6807; <code>view</code>&#xFF0C;&#x5373; <code>mFirstTouchTarget</code> &#x3002;&#x5F53;&#x6EE1;&#x8DB3;&#x4E8B;&#x4EF6;&#x672A;&#x53D6;&#x6D88;&#x3001;&#x672A;&#x62E6;&#x622A;&#x4E14;&#x5F53;&#x524D;&#x4E8B;&#x4EF6;&#x4E3A;<code>down</code> <code>pointer_down</code> <code>hover_move</code> &#x5176;&#x4E00;&#x7684;&#x624D;&#x4F1A;&#x8FDB;&#x5165;&#x8BE5;&#x6D41;&#x7A0B;&#x3002;</li>
<li>&#x4E8B;&#x4EF6;&#x5206;&#x53D1;&#x3002;&#x6839;&#x636E;&#x662F;&#x5426;&#x627E;&#x5230;&#x76EE;&#x6807; <code>view</code> &#x51B3;&#x5B9A;&#xFF0C;&#x5206;&#x53D1;&#x7ED9; <code>mFirstTouchTarget</code> &#x8FD8;&#x662F;&#x5206;&#x53D1;&#x7ED9;&#x81EA;&#x5DF1;&#x3002;</li>
</ol>
<h3 id="activity-&#x6E90;&#x7801;&#x5206;&#x6790;"><a href="#Activity-&#x6E90;&#x7801;&#x5206;&#x6790;" class="headerlink" title="Activity &#x6E90;&#x7801;&#x5206;&#x6790;"></a>Activity &#x6E90;&#x7801;&#x5206;&#x6790;</h3><h4 id="activityontouchevent"><a href="#Activity-onTouchEvent" class="headerlink" title="Activity.onTouchEvent"></a>Activity.onTouchEvent</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">onTouchEvent</span><span class="params">(MotionEvent event)</span> </span>{</span><br><span class="line">    <span class="keyword">if</span> (mWindow.shouldCloseOnTouch(<span class="keyword">this</span>, event)) {</span><br><span class="line">        finish();</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">    }</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">}</span><br></pre></td></tr></table></figure>
<h4 id="activitydispatchtouchevent"><a href="#Activity-dispatchTouchEvent" class="headerlink" title="Activity.dispatchTouchEvent"></a>Activity.dispatchTouchEvent</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">dispatchTouchEvent</span><span class="params">(MotionEvent ev)</span> </span>{</span><br><span class="line">    <span class="keyword">if</span> (ev.getAction() == MotionEvent.ACTION_DOWN) {</span><br><span class="line">        onUserInteraction();</span><br><span class="line">    }</span><br><span class="line">    <span class="keyword">if</span> (getWindow().superDispatchTouchEvent(ev)) {</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">    }</span><br><span class="line">    <span class="keyword">return</span> onTouchEvent(ev);</span><br><span class="line">}</span><br></pre></td></tr></table></figure>
<p><code>getWindow()</code> &#x8FD4;&#x56DE;&#x7684; <code>Window</code> &#x5B9E;&#x4F8B;&#x5176;&#x5B9E;&#x662F; <code>PhoneWindow</code> &#x7C7B;&#x578B;&#x3002;&#x6B64;&#x5904;&#x4E0D;&#x518D;&#x5177;&#x4F53;&#x8BF4;&#x660E;&#x3002;<br><code>PhoneWindow</code> &#x7684;&#x5B9E;&#x73B0;&#x4EC5;&#x4EC5;&#x8C03;&#x7528;&#x4E86; <code>DecorView</code> &#x7684; <code>superDispatchTouchEvent(event)</code> &#x65B9;&#x6CD5;&#x3002;<br>&#x4E00;&#x8DEF;&#x8FFD;&#x67E5;&#x4E0B;&#x53BB;&#xFF0C;<code>DecorView</code>&#x8C03;&#x7528;&#x5176;&#x7236;&#x7C7B; <code>FrameLayout</code>  &#x7684; <code>dispatchTouchEvent</code> &#x65B9;&#x6CD5;&#xFF0C;<code>FrameLayout</code> &#x65B9;&#x6CD5;&#x7EE7;&#x627F;&#x81EA; <code>ViewGroup</code>&#xFF0C;&#x4E14;&#x6CA1;&#x6709;&#x590D;&#x5199;&#x8BE5;&#x65B9;&#x6CD5;&#x3002;<br>&#x7EFC;&#x4E0A;&#xFF0C;<strong><code>Activity</code> &#x7684; <code>diapatchTouchEvent</code> &#x7684;&#x65B9;&#x6CD5;&#x6700;&#x7EC8;&#x8C03;&#x7528; <code>ViewGroup</code> &#x7684; <code>dispatchTouchEvent</code> &#x65B9;&#x6CD5;</strong>&#x3002;</p>
<h2 id="&#x4EE3;&#x7801;&#x6D4B;&#x8BD5;"><a href="#&#x4EE3;&#x7801;&#x6D4B;&#x8BD5;" class="headerlink" title="&#x4EE3;&#x7801;&#x6D4B;&#x8BD5;"></a>&#x4EE3;&#x7801;&#x6D4B;&#x8BD5;</h2><h3 id="&#x6D4B;&#x8BD5;&#x4E00;"><a href="#&#x6D4B;&#x8BD5;&#x4E00;" class="headerlink" title="&#x6D4B;&#x8BD5;&#x4E00;"></a><span id="test_1">&#x6D4B;&#x8BD5;&#x4E00;</span></h3><p>&#x6240;&#x6709;&#x65B9;&#x6CD5;&#x5747;&#x8FD4;&#x56DE;&#x7236;&#x7C7B;&#x65B9;&#x6CD5;&#x8C03;&#x7528;&#x3002;<br><img src="/assets/images/android &#x4E8B;&#x4EF6;&#x4F20;&#x9012;&#x5206;&#x6790;/test_01.png" alt=""><br><code>CustonView</code> &#x548C; <code>CustomViewGourp</code> &#x7684; <code>onTouch</code> &#x65B9;&#x6CD5;&#x5BF9; <code>down</code> &#x4E8B;&#x4EF6;&#x8FD4;&#x56DE; <code>false</code> &#xFF0C;&#x4E0D;&#x80FD;&#x6210;&#x4E3A; <code>mFirstTouchTarget</code> &#x3002;&#x4E4B;&#x540E;&#xFF0C;DecorView &#x7684; <code>dispatchTouchEvent</code> &#x8FD4;&#x56DE; <code>false</code> &#xFF0C;<code>Activity</code> &#x4E2D; <code>getWindow().superDispatchTouchEvent()</code> &#x8FD4;&#x56DE; <code>false</code> &#xFF0C;&#x6700;&#x540E;&#x8C03;&#x7528; <code>Activity</code> &#x7684; <code>onTouchEvent</code> &#x65B9;&#x6CD5;&#x3002;<br>&#x8FDB;&#x4E00;&#x6B65;&#xFF0C;&#x5F53; <code>DecorView</code> &#x6536;&#x5230; <code>action_move</code> &#x4E8B;&#x4EF6;&#x65F6;&#xFF0C;&#x4E0D;&#x8FDB;&#x884C;&#x5BFB;&#x627E; <code>mFirstTouchTarget</code> &#x64CD;&#x4F5C;&#x4E14;&#x4E4B;&#x524D;&#x6CA1;&#x6709;&#x627E;&#x5230; <code>mFirstTouchTarget</code> &#xFF0C;&#x6240;&#x4EE5; <code>DecorView</code> &#x76F4;&#x63A5;&#x5C06;&#x8BE5;&#x4E8B;&#x4EF6;&#x4EA4;&#x7ED9;&#x81EA;&#x5DF1;&#x5904;&#x7406;&#xFF0C;&#x8FD9;&#x4E5F;&#x9020;&#x6210;&#x4E86; <code>CustomViewGroup</code> <code>CustomView</code> &#x65E0;&#x6CD5;&#x63A5;&#x53D7;&#x540E;&#x7EED;&#x4E8B;&#x4EF6;&#x3002;<br><code>action_up</code> &#x4E8B;&#x4EF6;&#x4E0E; <code>action_move</code> &#x4E8B;&#x4EF6;&#x5904;&#x7406;&#x6D41;&#x7A0B;&#x76F8;&#x540C;&#x3002;</p>
<h3 id="&#x6D4B;&#x8BD5;&#x4E8C;"><a href="#&#x6D4B;&#x8BD5;&#x4E8C;" class="headerlink" title="&#x6D4B;&#x8BD5;&#x4E8C;"></a><span id="test_2">&#x6D4B;&#x8BD5;&#x4E8C;</span></h3><p>&#x4FEE;&#x6539; <code>CustomView</code> <code>onTouchEvent</code> &#x65B9;&#x6CD5;&#xFF0C; <code>action_down</code> &#x65F6;&#x8FD4;&#x56DE; <code>true</code>&#xFF0C;&#x5176;&#x4ED6;&#x90FD;&#x8FD4;&#x56DE;&#x7236;&#x7C7B;&#x8C03;&#x7528;&#x3002;<br><img src="/assets/images/android &#x4E8B;&#x4EF6;&#x4F20;&#x9012;&#x5206;&#x6790;/test_02.png" alt=""><br>&#x6CE8;&#x610F;&#xFF0C;CustomView &#x4E0D;&#x6D88;&#x8D39; <code>action_move</code> &#x4E8B;&#x4EF6;&#xFF0C;&#x4F46;&#x662F;&#x8BE5;&#x4E8B;&#x4EF6;&#x5E76;&#x6CA1;&#x6709;&#x4F20;&#x9012;&#x7ED9; <code>CustomViewGroup</code> &#x7684; <code>onTouchEvent</code> &#x3002;<br>&#x56E0;&#x4E3A;&#x5F53; <code>action_move</code> &#x53D1;&#x751F;&#x65F6;&#xFF0C;<code>mFirstTouchTarget</code> &#x4E0D;&#x4E3A;&#x7A7A;&#xFF0C;&#x4FDD;&#x5B58;&#x7684;&#x5C31;&#x662F; <code>CustomView</code> &#x3002;&#x54EA;&#x6015; <code>CustomView</code> &#x5BF9; <code>action_move</code> &#x8FD4;&#x56DE; <code>false</code> , <code>CustomViewGroup</code> &#x4E5F;&#x65E0;&#x6CD5;&#x518D;&#x83B7;&#x5F97;&#x5904;&#x7406;&#x6743;&#x3002;<br>&#x5982;&#x679C; <code>CustomViewGroup</code> &#x60F3;&#x5904;&#x7406; <code>action_move</code> &#xFF0C;&#x5FC5;&#x987B;&#x4F7F;&#x7528; <code>onInterceptTouchEvent</code> &#x65B9;&#x6CD5;&#x3002;</p>
<h3 id="&#x6D4B;&#x8BD5;&#x4E09;"><a href="#&#x6D4B;&#x8BD5;&#x4E09;" class="headerlink" title="&#x6D4B;&#x8BD5;&#x4E09;"></a><span id="test_3">&#x6D4B;&#x8BD5;&#x4E09;</span></h3><p>&#x4FEE;&#x6539; <code>CustonViewGroup</code> <code>onInterceptTouchEvent</code> &#x65B9;&#x6CD5;&#xFF0C;<code>action_down</code> &#x65F6;&#x8FD4;&#x56DE; <code>true</code>&#xFF0C;&#x5176;&#x4ED6;&#x90FD;&#x8FD4;&#x56DE;&#x7236;&#x7C7B;&#x8C03;&#x7528;&#x3002;<br><img src="/assets/images/android &#x4E8B;&#x4EF6;&#x4F20;&#x9012;&#x5206;&#x6790;/test_03.png" alt=""><br>&#x56E0;&#x4E3A; <code>CustonViewGroup</code> &#x4E2D;&#x65AD;&#x4E86; <code>action_down</code> &#x4E8B;&#x4EF6;&#x7684;&#x4F20;&#x9012;&#xFF0C;&#x8BE5;&#x4E8B;&#x4EF6;&#x76F4;&#x63A5;&#x4F20;&#x9012;&#x7ED9; <code>CustomViewGroup</code> &#x7684; <code>onTouchEnent</code> &#x3002;<br><code>CustonViewGroup</code> &#x548C; <code>CustonView</code> &#x90FD;&#x6CA1;&#x6709;&#x6210;&#x4E3A; <code>mFirstTouchTarget</code>&#xFF0C;&#x4F46;&#x662F;&#x539F;&#x56E0;&#x4E0D;&#x540C;&#x3002; <code>CustomView</code> &#x538B;&#x6839;&#x6CA1;&#x6536;&#x5230; <code>action_down</code>&#xFF0C;&#x800C; <code>CutstonViewGroup</code> &#x662F;&#x6536;&#x5230;&#x4E86; <code>action_down</code> &#x4E8B;&#x4EF6;&#x4F46;&#x662F;&#x4E0D;&#x60F3;&#x6D88;&#x8D39;&#xFF08;<code>onTouchEvent</code> &#x8FD4;&#x56DE; <code>false</code>&#xFF09;&#x3002;</p>
<h3 id="&#x6D4B;&#x8BD5;&#x56DB;"><a href="#&#x6D4B;&#x8BD5;&#x56DB;" class="headerlink" title="&#x6D4B;&#x8BD5;&#x56DB;"></a><span id="test_4">&#x6D4B;&#x8BD5;&#x56DB;</span></h3><p>&#x5982;&#x679C;&#x4FEE;&#x6539;<code>CustonViewGroup</code> <code>onInterceptTouchEvent</code> &#x65B9;&#x6CD5;&#xFF0C;<code>action_move</code> &#x65F6;&#x8FD4;&#x56DE; <code>true</code>&#xFF0C;&#x5176;&#x4ED6;&#x90FD;&#x8FD4;&#x56DE;&#x7236;&#x7C7B;&#x8C03;&#x7528;&#x3002; <code>CustomView</code> <code>onTouchEvent</code> &#x65B9;&#x6CD5;&#xFF0C; <code>action_down</code> &#x65F6;&#x8FD4;&#x56DE; <code>true</code> &#xFF0C;&#x5176;&#x4ED6;&#x90FD;&#x8FD4;&#x56DE;&#x7236;&#x7C7B;&#x8C03;&#x7528;&#x3002;<br><img src="/assets/images/android &#x4E8B;&#x4EF6;&#x4F20;&#x9012;&#x5206;&#x6790;/test_04.png" alt=""><br><code>action_down</code> &#x4E8B;&#x4EF6;&#x4F20;&#x9012;&#x6D41;&#x7A0B;&#x4E0E;&#x4E4B;&#x524D;&#x4FDD;&#x6301;&#x4E00;&#x81F4;&#xFF0C;&#x4F46;&#x662F; <code>action_move</code> &#x4E8B;&#x4EF6;&#x5C31;&#x6BD4;&#x8F83;&#x590D;&#x6742;&#xFF0C;&#x800C;&#x4E14;&#x6CE8;&#x610F;&#x5230;&#x524D;&#x540E;&#x4E24;&#x6B21;&#x7684; <code>action_move</code> &#x4E8B;&#x4EF6;&#x4F20;&#x9012;&#x6D41;&#x7A0B;&#x7ADF;&#x7136;&#x4E5F;&#x4E0D;&#x4E00;&#x6837;&#x3002;&#x7B2C;&#x4E00;&#x6B21;&#x6CA1;&#x6709;&#x8C03;&#x7528; <code>CustomViewGroup</code> &#x7684; <code>onTouchEvent</code>&#xFF0C;&#x800C;&#x7B2C;&#x4E8C;&#x6B21;&#x6CA1;&#x6709;&#x8C03;&#x7528; <code>onInterceptTouchEvent</code>  </p>
<ul>
<li>&#x7B2C;&#x4E00;&#x6B21; <code>action_move</code><br><code>CustonViewGroup</code> &#x6536;&#x5230; <code>action_move</code> &#x65F6;&#xFF0C;&#x4F1A;&#x4E2D;&#x65AD;&#x8BE5;&#x4E8B;&#x4EF6;&#x4F20;&#x9012;&#x3002;&#x6B64;&#x65F6;&#xFF0C; &#x4E0D;&#x9700;&#x8981;&#x8FDB;&#x884C;&#x5BFB;&#x627E;&#x76EE;&#x6807; <code>view</code> &#x64CD;&#x4F5C;&#xFF0C;<code>mFirstTouchTarget</code> &#x4E0D;&#x4E3A;&#x7A7A;&#x3002;<br>&#x4E4B;&#x540E;&#xFF0C;&#x4F1A;&#x8C03;&#x7528; <code>dispatchTransformedTouchEvent(MotionEvent event, boolean cancel, View child, int desiredPointerIdBits)</code> &#x3002;&#x5176;&#x4E2D;&#xFF0C;<code>event</code> &#x7684; <code>action</code> &#x4E3A; <code>move</code>,<br><code>cancel</code> &#x503C;&#x4E3A; <code>true</code>&#xFF0C;<code>child</code> &#x503C;&#x4E3A; <code>CustomView</code> &#xFF0C;<code>desiredPointerIdBits</code> &#x503C;&#x4E3A; <code>TouchTarget.ALL_POINTER_IDS</code>&#xFF08;&#x4E0D;&#x8003;&#x8651;&#x591A;&#x70B9;&#x89E6;&#x6478;&#xFF09;&#x3002;<br>&#x5728; <code>dispatchTransformedTouchEvent</code> &#x65B9;&#x6CD5;&#x5185;&#x90E8;&#xFF0C;&#x53D1;&#x9001; <code>action_cancel</code> &#x7ED9;&#x76EE;&#x6807; <code>view</code> &#xFF0C;&#x5373; <code>CustonView</code> &#x3002;<code>CustonView</code>&#x6536;&#x5230; <code>action_cancel</code> &#x8FD4;&#x56DE; <code>false</code> &#x3002;&#x6700;&#x540E;&#xFF0C;&#x8BE5;&#x65B9;&#x6CD5;&#x8FD4;&#x56DE; <code>false</code> &#x3002;<br><code>dispatchTransformedTouchEvent</code> &#x8FD4;&#x56DE;&#x540E;&#xFF0C;<code>dispatchTouchEvent</code> &#x8FD4;&#x56DE;&#x503C;&#x4ECD;&#x4E3A; <code>false</code>&#xFF0C;&#x4E4B;&#x540E;&#x9500;&#x6BC1; <code>mFirstTouchTarget</code> &#x3002;<br><code>action_move</code> &#x4E00;&#x76F4;&#x6CA1;&#x6709;&#x88AB;&#x6D88;&#x8D39;&#xFF0C;&#x6700;&#x7EC8;&#x4F20;&#x9012;&#x5230; <code>Activity</code> &#x7684; <code>onTouchEvent</code> &#x65B9;&#x6CD5;&#x4E2D;&#x3002;&#x7B2C;&#x4E00;&#x6B21; <code>action_move</code> &#x4E8B;&#x4EF6;&#x5230;&#x6B64;&#x7ED3;&#x675F;&#x3002;<br>&#x53EF;&#x4EE5;&#x770B;&#x51FA;&#xFF0C;&#x56E0;&#x4E3A;&#x4E4B;&#x524D;&#x5B58;&#x5728; <code>mFirstTouchTarget</code>&#xFF0C;&#x6240;&#x4EE5;&#x5728; <code>CustomViewGroup</code> &#x62E6;&#x622A;&#x4E8B;&#x4EF6;&#x540E;&#xFF0C;&#x5E76;&#x6CA1;&#x6709;&#x628A;&#x4E8B;&#x4EF6;&#x4EA4;&#x7ED9;&#x81EA;&#x5DF1;&#x5904;&#x7406;&#x3002;</li>
<li>&#x7B2C;&#x4E8C;&#x6B21; <code>action_move</code><br><code>DecorView</code> &#x6536;&#x5230; <code>action_move</code> &#x4E8B;&#x4EF6;&#x65F6;&#xFF0C;&#x5176;&#x5185;&#x90E8;&#x7684; <code>mFirstTouchTarget</code> &#x4E0D;&#x4E3A;&#x7A7A;&#xFF0C;&#x4FDD;&#x5B58;&#x7684;&#x662F; <code>CustomViewGroup</code> &#x3002;<br>&#x6CE8;&#x610F;&#xFF0C; <code>DecorView</code> &#x7684; <code>mFirstTouchTarget</code> &#x6CA1;&#x6709;&#x88AB;&#x9500;&#x6BC1;&#xFF0C;&#x4E4B;&#x524D; <code>CustomViewGroup</code> &#x5BF9; <code>action_move</code> &#x8FD4;&#x56DE;&#x7684; <code>false</code> &#x4E5F;&#x5E76;&#x4E0D;&#x5F71;&#x54CD; <code>mFirstTouchTarget</code> &#x3002;<br>&#x6B64;&#x65F6;&#xFF0C;&#x4E0D;&#x9700;&#x8981;&#x5BFB;&#x627E;&#x76EE;&#x6807; <code>View</code> &#x3002;<code>DecorView</code> &#x628A;&#x4E8B;&#x4EF6;&#x76F4;&#x63A5;&#x4F20;&#x9012;&#x7ED9; <code>CustomViewGroup</code> &#x5904;&#x7406;&#x3002;<br><code>CustonViewGroup</code> &#x6536;&#x5230; <code>action_move</code> &#x65F6;&#xFF0C;&#x4ECD;&#x7136;&#x4E2D;&#x65AD;&#x4E8B;&#x4EF6;&#x4F20;&#x9012;&#x3002;&#x4F46;&#x6B64;&#x65F6; <code>mFirstTouchTarget</code> &#x4E3A;&#x7A7A;&#xFF0C;<code>CustomViewGroup</code> &#x53EA;&#x597D;&#x628A;&#x4E8B;&#x4EF6;&#x4EA4;&#x7ED9;&#x81EA;&#x5DF1;&#x5904;&#x7406;&#x3002;<code>action_move</code> &#x4F9D;&#x7136;&#x6CA1;&#x6709;&#x88AB;&#x6D88;&#x8D39;&#xFF0C;&#x6700;&#x7EC8;&#x4F20;&#x9012;&#x5230; <code>Activity</code> &#x7684; <code>onTouchEvent</code> &#x65B9;&#x6CD5;&#x4E2D;&#x3002;  </li>
</ul>
<p>&#x4E24;&#x6B21; <code>action_move</code> &#x4F20;&#x9012;&#x6D41;&#x7A0B;&#x7684;&#x533A;&#x522B;&#x5728;&#x4E8E;&#xFF1A;&#x7B2C;&#x4E00;&#x6B21;&#x51B3;&#x5B9A;&#x4E2D;&#x65AD;&#x4E8B;&#x4EF6;&#x64CD;&#x4F5C;&#x662F;&#x56E0;&#x4E3A; <code>onInterceptTouchEvent</code> &#x8FD4;&#x56DE; <code>true</code> &#x3002;&#x7B2C;&#x4E8C;&#x6B21;&#x51B3;&#x5B9A;&#x4E2D;&#x65AD;&#x4E8B;&#x4EF6;&#x662F;&#x56E0;&#x4E3A; &#x6EE1;&#x8DB3;<code>actionMasked != MotionEvent.ACTION_DOWN &amp;&amp; mFirstTouchTarget == null</code> &#xFF0C;&#x5373; &#x201C;&#x4E0D;&#x662F; <code>action_down</code> &#x4E8B;&#x4EF6;&#x4E14;&#x6CA1;&#x6709;&#x76EE;&#x6807; <code>View</code>&#x201D;&#xFF0C;<code>ViewGroup</code> &#x53EA;&#x597D;&#x4EA4;&#x7ED9;&#x81EA;&#x5DF1;&#x5904;&#x7406;&#x3002;</p>
<h2 id="&#x53C2;&#x8003;&#x94FE;&#x63A5;"><a href="#&#x53C2;&#x8003;&#x94FE;&#x63A5;" class="headerlink" title="&#x53C2;&#x8003;&#x94FE;&#x63A5;"></a>&#x53C2;&#x8003;&#x94FE;&#x63A5;</h2><p><a href="http://blog.csdn.net/lfdfhl/article/details/42241253" target="_blank" rel="external">http://blog.csdn.net/lfdfhl/article/details/42241253</a><br><a href="https://github.com/CharonChui/AndroidNote/blob/master/Android&#x52A0;&#x5F3A;/Android%20Touch&#x4E8B;&#x4EF6;&#x5206;&#x53D1;&#x8BE6;&#x89E3;.md" target="_blank" rel="external">https://github.com/CharonChui/AndroidNote/blob/master/Android&#x52A0;&#x5F3A;/Android%20Touch&#x4E8B;&#x4EF6;&#x5206;&#x53D1;&#x8BE6;&#x89E3;.md</a><br><a href="http://wangkuiwu.github.io/2015/01/04/TouchEvent-ViewGroup/" target="_blank" rel="external">http://wangkuiwu.github.io/2015/01/04/TouchEvent-ViewGroup/</a></p>

      
    </div>
    
  </div>
  
    
<nav id="article-nav">
  
    <a href="/2016/03/17/LinearLayout onMeasure 过程分析/" id="article-nav-newer" class="article-nav-link-wrap">
      <strong class="article-nav-caption"><</strong>
      <div class="article-nav-title">
        
          LinearLayout onMeasure 过程分析
        
      </div>
    </a>
  
  
    <a href="/2016/02/17/hello-world/" id="article-nav-older" class="article-nav-link-wrap">
      <div class="article-nav-title">Hello World</div>
      <strong class="article-nav-caption">></strong>
    </a>
  
</nav>

  
</article>








</div>
      <footer id="footer">
  <div class="outer">
    <div id="footer-info">
    	<div class="footer-left">
    		&copy; 2016 Azzwen
    	</div>
      	<div class="footer-right">
      		<a href="http://hexo.io/" target="_blank">Hexo</a>  Theme <a href="https://github.com/litten/hexo-theme-yilia" target="_blank">Yilia</a> by Litten
      	</div>
    </div>
  </div>
</footer>
    </div>
    
  <link rel="stylesheet" href="/fancybox/jquery.fancybox.css" type="text/css">


<script>
	var yiliaConfig = {
		fancybox: true,
		mathjax: true,
		animate: true,
		isHome: false,
		isPost: true,
		isArchive: false,
		isTag: false,
		isCategory: false,
		open_in_new: false
	}
</script>
<script src="http://7.url.cn/edu/jslib/comb/require-2.1.6,jquery-1.9.1.min.js" type="text/javascript"></script>
<script src="/js/main.js" type="text/javascript"></script>






<script type="text/x-mathjax-config">
MathJax.Hub.Config({
    tex2jax: {
        inlineMath: [ ['$','$'], ["\\(","\\)"]  ],
        processEscapes: true,
        skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
    }
});

MathJax.Hub.Queue(function() {
    var all = MathJax.Hub.getAllJax(), i;
    for(i=0; i < all.length; i += 1) {
        all[i].SourceElement().parentNode.className += ' has-jax';                 
    }       
});
</script>

<script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script>


  </div>
</body>
</html>